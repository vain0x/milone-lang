// FNV-1a hash
module rec LibHash.FnvHash

let fnv1aInit = 14695981039346656037UL

let fnv1aPrime = 1099511628211UL

let fnv1aReduceUInt8 (n: byte) (h: uint64) = (h ^^^ uint64 n) * fnv1aPrime

let fnv1aReduceUInt16 (n: uint16) (h: uint64) =
  h
  |> fnv1aReduceUInt8 (byte (n &&& 15us))
  |> fnv1aReduceUInt8 (byte ((n >>> 8) &&& 15us))

let fnv1aReduceUInt (n: uint) (h: uint64) =
  h
  |> fnv1aReduceUInt16 (uint16 (n &&& 255u))
  |> fnv1aReduceUInt16 (uint16 ((n >>> 16) &&& 255u))
