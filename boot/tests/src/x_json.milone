// Incomplete.

let isDigit c =
  '0' <= c && c <= '9'

let tokenize (s : string) =
  let rec readInt i =
    if i >= s.Length || not (isDigit s.[i]) then
      i
    else
      readInt (i + 1)

  let rec go i =
    if i < s.Length then
      if s.[i] = ' ' then
        go (i + 1)
      else if s.[i] = '[' || s.[i] = ']' || s.[i] = ',' then
        printfn "punct %c" s.[i]
        go (i + 1)
      else if isDigit s.[i] then
        let r = readInt i
        printfn "int %s" s.[i..r - 1]
        go r
  go 0

let main _ =
  let source = "[0, 1000000007, 314159]"
  tokenize source
  0
