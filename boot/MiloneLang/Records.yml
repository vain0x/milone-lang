ScopeCtx:
  # Last serial number.
  # We need manage identifiers as integers rather than strings due to shadowing.
  Serial: Serial

  # Serial to ident map.
  NameMap: Map<Serial, Ident>

  # Variable serial to definition map.
  Vars: Map<VarSerial, VarDef>

  # Variable serial to let-depth map.
  VarDepths: Map<VarSerial, LetDepth>

  # Type serial to definition map.
  Tys: Map<TySerial, TyDef>

  # Type serial to let-depth map.
  TyDepths: Map<TySerial, LetDepth>

  # Serial of the current scope.
  LocalSerial: ScopeSerial

  # Current scope.
  Local: Scope

  # Current let-depth, the number of ancestral let-body.
  LetDepth: LetDepth

TyContext:
  Serial: Serial
  Tys: Map<TySerial, TyDef>
  TyDepths: Map<TySerial, LetDepth>

TyCtx:
  # Next serial number.
  # We need to identify variables by serial number rather than names
  # due to scope locality and shadowing.
  Serial: Serial

  # Variable serial to variable definition.
  Vars: Map<VarSerial, VarDef>

  # Type serial to type definition.
  Tys: Map<TySerial, TyDef>

  TyDepths: Map<TySerial, LetDepth>
  LetDepth: LetDepth
  TraitBounds: (Trait * Loc) list
  Logs: (Log * Loc) list
