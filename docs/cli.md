# `milone` command usage

`milone` command is standard CLI interface for milone-lang projects.

## Subcommands

- [run](#run)
- [build](#build)

Less important:

- [check](#check)
- [compile](#compile)
- [help](#help)
- [version](#version)

### run

Run a project.

```sh
milone run <PROJECT-DIR> [-- ARGS...]
```

Examples:

```sh
milone run ./MiloneProject
```

```sh
milone run ./MiloneProject -- --flag arg1 arg2
```

Requirements:

- On linux:
    [GCC](#require-gcc),
    [ninja](#require-ninja-build)
- On windows:
    [MSBuild](#require-msbuild)

Options:

- `-- ARGS...`
    - Arguments for generated executable.
    - Note that `--` is required to pass some args.
- `--target-dir <DIR>` (defaults to `target/<PROJECT-NAME>`)
    - Specify target directory.
    - That directory contains intermediate files and output files.
    - Note that `<PROJECT-NAME>` is basename of project directory.

Output:

- Code:
    - 1 if compile failed.
    - Exit code that executed program returned.
- Stdout: Inherited to executed program.
- Stderr: Compile progress and compile errors. Inherited to executed program too.
- Files: Same as [build](#build)

### build

Build a project for an executable.

```sh
milone build <PROJECT-DIR>
```

Examples:

```sh
milone build ./MiloneProject
```

```sh
milone build ./MiloneProject --target-dir ../build
```

Options:

- `--target-dir <DIR>` (defaults to `target/<PROJECT-NAME>`)
    - Specify target directory.
    - That directory contains intermediate files and output files.
    - Note that `<PROJECT-NAME>` is basename of project directory.

Output:

- Code: 0 if success. 1 if error.
- Stdout: Compilation progress and compile errors.
- Files:
    - `<TARGET-DIR>/*.c`: C files (if success)
    - `<TARGET-DIR>/<PROJECT-NAME>.exe`: Executable (if success)
    - where `TARGET-DIR` is specified by `--target-dir` option
    - On linux:
        - `<TARGET-DIR>/build.ninja` 
    - On windows:
        - `<TARGET-DIR>/<PROJECT-NAME>.sln`
        - `<TARGET-DIR>/<PROJECT-NAME>/<PROJECT-NAME>.vcxproj`
        - `<TARGET-DIR>/<PROJECT-NAME>/target/**` (generated by MSBuild)

### check

Check if a project is *valid*.

```sh
milone check <PROJECT-DIR>
```

Examples:

```sh
milone check ./MiloneProject
```

Description:

- Valid means:
    - *well-formed* (parsing is okay), and
    - *well-typed* (type checking is okay).
- Report compile errors.
- Unlike `build` subcommand, code generation is skipped for faster feedback.

Output:

- Code: 0 if okay.
- Stdout: Compile errors if any.

### compile

Compile a project to C source files.

Examples:

```sh
milone compile <PROJECT-DIR>
```

```sh
milone compile ./MiloneProject
```

Output:

- Code: 0 if success. 1 if error.
- Stdout: Compilation progress and compile errors.
- Files:
    - `<TARGET-DIR>/*.c`: C files (if success)
    - `<TARGET-DIR>/<PROJECT-NAME>.exe`: Executable (if success)

### help

Print help text of the milone command.

```sh
milone help
```

Equivalent:

```sh
milone
milone -h
milone --help
```

Output:

- Code: 0.
- Stdout: Help text.

### version

Print version number of the milone command.

```sh
milone version
```

Equivalent:

```sh
milone -V
milone --version
```

Output:

- Code: 0.
- Stdout: `0.0.0\n` for example.

----

## Requirements

Some of subcommands require something on runtime environment.

### require-GCC

(On linux only.)

Install GCC 7.5.0.

Notes:

- Installation process varies.
    - I did `sudo apt install build-essential` on Ubuntu.
- `clang` is also okay. Set `CC` environment variable to `clang`.

### require-ninja-build

(On linux only.)

Install [ninja-build 1.10.2](https://github.com/ninja-build/ninja).

Notes:

- `ninja` command (also known as `ninja-build`) is a build tool.
- It runs subprocesses and provides some profits. Ninja does:
    - print progress messages nicely
    - run subprocesses in parallel
    - skip unnecessary jobs

### require-MSBuild

(On windows only.)

Install `MSBuild.exe` in some way:

- install Visual Studio 2019 with "Desktop development with C++" option, *OR*
- install [Visual Studio 2019 Build Tools](https://visualstudio.microsoft.com/ja/downloads/?q=build+tools#build-tools-for-visual-studio-2019).

Notes:

- `MSBuild.exe` is a build tool that is used to compile C (MSVC) project on windows.
- (I'm not familiar with these tools.)

----

## Misc notes

- I'm NOT familiar with external tools; please teach me.
- CLI interface is similar to `cargo` (in Rust).
- On linux: consider to install [mold](https://github.com/rui314/mold) for faster linking.
